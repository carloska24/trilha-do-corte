generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model services {
  id          String         @id
  name        String?
  price       String?
  priceValue  Float?         @map("pricevalue")
  description String?
  icon        String?
  image       String?
  category    String?
  activePromo String?        @map("activepromo")
  duration    Int?
  badges      String?
  appointments appointments[]
}

model barbers {
  id           String         @id
  name         String?
  specialty    String?
  image        String?
  email        String?
  phone        String?
  password     String?
  appointments appointments[]
}

model clients {
  id           String         @id
  name         String?
  phone        String?
  level        Int?
  lastVisit    String?        @map("lastvisit")
  img          String?
  status       String?
  notes        String?
  password     String?
  email        String?
  appointments appointments[]
}

model appointments {
  id         String    @id
  clientName String?   @map("clientname")
  serviceId  String?   @map("serviceid")
  date       DateTime? @db.Date
  time       String?
  status     String?
  price      Float?
  photoUrl   String?   @map("photourl")
  notes      String?
  clientId   String?   @map("clientid")
  barberId   String?   @map("barberid")

  // Relations
  client     clients?  @relation(fields: [clientId], references: [id])
  barber     barbers?  @relation(fields: [barberId], references: [id])
  service    services? @relation(fields: [serviceId], references: [id])

  @@unique([date, time], map: "idx_appointments_unique_slot")
}

model shop_settings {
  id           String @id @default(uuid())
  startHour    Int    @default(9) @map("starthour")
  endHour      Int    @default(19) @map("endhour")
  slotInterval Int    @default(30) @map("slotinterval")
  closedDays   Int[]  @default([0]) @map("closeddays") // 0 = Sunday
  exceptions   Json?  @default("{}") // { "YYYY-MM-DD": { closed: boolean, start: int, end: int } }
}
